---
depends_on:
  - gitleaks
  - ansible-lint

skip_clone: true

steps:
  notify:
    name: notify
    image: registry.mgrote.net/allzweckcontainer:latest
    commands:
      - |
        s-nail -s "CI: [$CI_PIPELINE_STATUS] $CI_REPO ($CI_COMMIT_BRANCH" \
        -S smtp=server:docker10.mgrote.net:1025 \
        -S from=ci@mgrote.net info@mgrote.net <<EOF
        $CI_REPO
        $CI_COMMIT_SHA
        $CI_PIPELINE_URL
        $CI_STEP_STATUS
        EOF
    when:
      event: [push]

runs_on: [ success, failure ]

# mail als extra file das immer getriggert wird
# nutze allzweckcontainer mit mailx
