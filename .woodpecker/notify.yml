---
depends_on:
  - gitleaks
  - ansible-lint

steps:
  notify:
    name: notify
    image: deblan/woodpecker-email
    settings:
      dsn: "smtp://docker10.mgrote.net:1025"
      from:
        address: "ci@mgrote.net"
        name: "woodpecker"
      recipients:
        - info@mgrote.net
      content:
        subject: "[{{ pipeline.status }}] {{ repo.full_name }} ({{ commit.branch }}"
        body: |
          {{ repo.full_name }}<br>
          {{ commit.sha }}<br>
          {{ pipeline.url }}<br>
          {{ step.status }}<br>

runs_on: [ failure ]
