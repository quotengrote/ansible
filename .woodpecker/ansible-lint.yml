---
depends_on:
  - gitleaks
  - lint

steps:
  ansible-lint:
    image: quay.io/ansible/creator-ee@sha256:90298d88bc38f057e199523b8143c2c4cf9c159547ef93cf62d8861390c5600a
    commands:
      - ansible-lint --version
      - echo $${VAULTPASS} > ./vault-pass.yml # nach des Secret in Gro√üschreibung
      - ansible-galaxy install -r requirements.yml
      - ansible-lint --force-color --format pep8
    when:
      event:
        exclude:
          - tag
    secrets:
      - source: vault-pass # name des Secrets in Woodpecker/GUI
        target: vaultpass # lower-case Name der Variable zur Verwendung in dem CI-File, wird dann so genutzt $${VAULTPASS}
