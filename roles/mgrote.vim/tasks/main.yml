---
  - name: install packages
    become: yes
    ansible.builtin.package:
      name:
        - vim
        - ripgrep
      state: present

  - name: check if vundle is installed - folder
    become: yes
    stat:
      path: "/home/mg/.vim/bundle/Vundle.vim"
    register: folder_exists

  - name: Ensure  repository is cloned locally.
    git:
      repo: https://github.com/VundleVim/Vundle.vim.git
      dest: /home/mg/.vim/bundle/Vundle.vim
      depth: 1

  - name: set owner recursive for repo
    file:
      path: /home/mg/.vim
      owner: mg
      group: mg
      recurse: yes

  - name: Vundle - PluginInstall
    ansible.builtin.shell: yes | vim -c PluginInstall -c qall
    args:
      chdir: /home/mg
    become_user: mg
  #  when: (folder_exists.stat.exists == False)
