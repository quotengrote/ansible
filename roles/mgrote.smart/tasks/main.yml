---
  - name: include user tasks
    include_tasks: user.yml

  - name: ensure smartmontools are installed
    become: yes
    ansible.builtin.package:
      name: smartmontools
      state: present

  - name: template smartmontools config
    become: yes
    ansible.builtin.template:
      src: "smartmontools"
      dest: "/etc/default/smartmontools"
      owner: "{{ smart_user }}"
      group: "{{ smart_user_group }}"
    notify: restart smartmontools

  - name: template smartd.conf
    become: yes
    ansible.builtin.template:
      src: "smartd.conf"
      dest: "/etc/smartd.conf"
      owner: "{{ smart_user }}"
      group: "{{ smart_user_group }}"
    notify: restart smartmontools

  - name: copy smart_status.sh
    become: yes
    ansible.builtin.template:
      src: "smart_status.sh"
      dest: "/usr/local/bin/smart_status.sh"
      owner: "{{ smart_user }}"
      group: "{{ smart_user_group }}"
      mode: 0744
