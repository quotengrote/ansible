version: '3.3'
services:
    postfix:
      image: "registry.mgrote.net/postfix:master@sha256:1d3a194ee7a9cc2b7537ce8142bd9a98dcb1890b33bf5d482eeaa8b347dc9398"
      container_name: mail-relay
      restart: always
      labels:
        com.centurylinklabs.watchtower.enable: true
      ports:
          - 1025:25
      environment:
        SMTP_SERVER: smtp.strato.de
        SMTP_USERNAME: info@mgrote.net
        SMTP_PASSWORD: "{{ lookup('keepass', 'strato_smtp_password', 'password') }}"
        SERVER_HOSTNAME: mgrote.net
        # DEBUG: "yes" # literal
        ALWAYS_ADD_MISSING_HEADERS: "no" # literal
        # LOG_SUBJECT: "yes" # literal
        INET_PROTOCOL: ipv4
        SMTP_GENERIC_MAP: "/.*/ info@mgrote.net"
      networks:
        - mail-relay

######## Networks ########
networks:
  mail-relay:
    external: true
